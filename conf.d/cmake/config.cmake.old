

set(PROJECT_NAME redis-test-binding)
set(PROJECT_VERSION 1.0)
set(PROJECT_PRETTY_NAME "Agl Test Binding of Redis Plugin")
set(PROJECT_DESCRIPTION "Test Binding of the redis plugin;  Redis Time Series database")
set(PROJECT_URL "git@git.ovh.iot:tbultel/agl-redis-test-binding.git")
set(PROJECT_ICON "icon.png")
set(PROJECT_AUTHOR "Thierry Bultel")
set(PROJECT_AUTHOR_MAIL "thierry.bultel@iot.bzh")
set(PROJECT_LICENSE "APL2.0")
set(PROJECT_LANGUAGES "CXX")
set(API_NAME "redis")

set (PKG_REQUIRED_LIST
	afb-daemon
	afb-helpers
	ctl-utilities
	lua53>=5.3
)

add_definitions(-DCONTROL_PLUGIN_PATH="${CMAKE_BINARY_DIR}/package/lib/plugins:${CMAKE_INSTALL_PREFIX}/${PROJECT_NAME}/lib/plugins:${CMAKE_INSTALL_PREFIX}/${PROJECT_NAME}")
add_definitions(-DCONTROL_CONFIG_PATH="${CMAKE_SOURCE_DIR}/conf.d/project/etc:${CMAKE_BINARY_DIR}/package/etc:${CMAKE_INSTALL_PREFIX}/${PROJECT_NAME}/etc:${CMAKE_INSTALL_PREFIX}/${PROJECT_NAME}")
add_definitions(-DAFB_BINDING_VERSION=3)


set(WIDGET_TYPE application/vnd.agl.resource)
set(WIDGET_CONFIG_TEMPLATE "${CMAKE_SOURCE_DIR}/conf.d/wgt/config.xml.in" CACHE PATH "Path to widget config file template (config.xml.in)")
set(WIDGET_ENTRY_POINT lib/afb-signal-composer.so)
add_definitions(-DCTL_PLUGIN_MAGIC=987456123)



set(CONTROL_SUPPORT_LUA 1)
set(CMAKE_PREFIX_PATH ${CMAKE_INSTALL_PREFIX}/lib64/pkgconfig ${CMAKE_INSTALL_PREFIX}/lib/pkgconfig)
set(LD_LIBRARY_PATH ${CMAKE_INSTALL_PREFIX}/lib64 ${CMAKE_INSTALL_PREFIX}/lib)

set(CLOSING_MESSAGE "Typical binding launch: afb-daemon --name redis-test --port=${AFB_REMPORT} --workdir=${CMAKE_BINARY_DIR} --ldpath=/dev/null --binding=package/lib/redis-test-binding.so --roothttp=package/htdocs --token=\"${AFB_TOKEN}\" --tracereq=common --verbose")
set(PACKAGE_MESSAGE "Install widget file using in the target : afm-util install ${PROJECT_NAME}.wgt")

include(CMakeAfbTemplates)
